function [I] = int2DimSimpsonOrder3(x,y,f)
    
    dx = x(2) - x(1);
    x_0 = x(1);
    x_1 = x(2);
    x_2 = x(3);
    x_3 = x(4);
 
    L_x_0 = @(x) (x-x_1)/(x_0-x_1) * (x-x_2)/(x_0-x_2) * (x-x_3)/(x_0-x_3);
    L_x_1 = @(x) (x-x_0)/(x_1-x_0) * (x-x_2)/(x_1-x_2) * (x-x_3)/(x_1-x_3);
    L_x_2 = @(x) (x-x_0)/(x_2-x_0) * (x-x_1)/(x_2-x_1) * (x-x_3)/(x_2-x_3);
    L_x_3 = @(x) (x-x_0)/(x_3-x_0) * (x-x_1)/(x_3-x_1) * (x-x_2)/(x_3-x_2);

    dy = y(2) - y(1);
    y_0 = y(1);
    y_1 = y(2);
    y_2 = y(3);
    y_3 = y(4);

    L_y_0 = @(y) (y-y_1)/(y_0-y_1) * (y-y_2)/(y_0-y_2) * (y-y_3)/(y_0-y_3);
    L_y_1 = @(y) (y-y_0)/(y_1-y_0) * (y-y_2)/(y_1-y_2) * (y-y_3)/(y_1-y_3);
    L_y_2 = @(y) (y-y_0)/(y_2-y_0) * (y-y_1)/(y_2-y_1) * (y-y_3)/(y_2-y_3);
    L_y_3 = @(y) (y-y_0)/(y_3-y_0) * (y-y_1)/(y_3-y_1) * (y-y_2)/(y_3-y_2);

    f_x0_y0 = f(1,1);
    f_x1_y0 = f(1,2);
    f_x2_y0 = f(1,3);
    f_x3_y0 = f(1,4);

    f_x0_y1 = f(2,1);
    f_x1_y1 = f(2,2);
    f_x2_y1 = f(2,3);
    f_x3_y1 = f(2,4);
    
    f_x0_y2 = f(3,1);
    f_x1_y2 = f(3,2);
    f_x2_y2 = f(3,3);
    f_x3_y2 = f(3,4);

    f_x0_y3 = f(4,1);
    f_x1_y3 = f(4,2);
    f_x2_y3 = f(4,3);
    f_x3_y3 = f(4,4);

    g_0 = @(y) L_y_0(y)*f_x0_y0 + L_y_1(y)*f_x0_y1 + L_y_2(y)*f_x0_y2 + L_y_3(y)*f_x0_y3;
    g_1 = @(y) L_y_0(y)*f_x1_y0 + L_y_1(y)*f_x1_y1 + L_y_2(y)*f_x1_y2 + L_y_3(y)*f_x1_y3;
    g_2 = @(y) L_y_0(y)*f_x2_y0 + L_y_1(y)*f_x2_y1 + L_y_2(y)*f_x2_y2 + L_y_3(y)*f_x2_y3;
    g_3 = @(y) L_y_0(y)*f_x3_y0 + L_y_1(y)*f_x3_y1 + L_y_2(y)*f_x3_y2 + L_y_3(y)*f_x3_y3;

    h_0 = (3*dy/8)*(g_0(y_0) + 3*g_0(y_1) + 3*g_0(y_2) + g_0(y_3));
    h_1 = (3*dy/8)*(g_1(y_0) + 3*g_1(y_1) + 3*g_1(y_2) + g_1(y_3));
    h_2 = (3*dy/8)*(g_2(y_0) + 3*g_2(y_1) + 3*g_2(y_2) + g_2(y_3));
    h_3 = (3*dy/8)*(g_3(y_0) + 3*g_3(y_1) + 3*g_3(y_2) + g_3(y_3));

    J = @(x) L_x_0(x)*h_0 + L_x_1(x)*h_1 + L_x_2(x)*h_2 + L_x_3(x)*h_3;

    I = (3*dx/8)*(J(x_0) + 3*J(x_1) + 3*J(x_2) + J(x_3));
end